<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<title>UK Festivals</title>

<!--Set up the CSS styles-->
<style type="text/css">
      html {
	      height: 100%;
	  }

	  body {
		  height: 100%;
		  margin: 0;
		  padding: 0;
		  background: /*url*/('icons/old_paper.jpg') no-repeat 0 0;
       /*background-size: cover*/
	  }
    /*.map-wrapper {
      background: url(http://placekitten.com/1500/1500) no-repeat 0 0;
      background-size: cover;
    }*/

	  /*Adapt the following styling depending on where you want to put your map. If you want a 'full screen' map, then set the width and height to 100 percent and remove the margins.*/
    #wrapper {
      position: relative;
      height: 100%;
		  width: 100%;
    }

    #festival-map {
      position: absolute;
	  	height: 100%;
		  width: 100%;
		  margin-left: auto;
      margin-right: auto;
		  border-right-width: 2px;
		  border-right-color: #ffffff;
		  border-right-style: solid;
		  border-left-width: 2px;
		  border-left-color: #ffffff;
		  border-left-style: solid;
	  }

    #over-map {
      position: absolute;
      top: 30%;
      left: 500px;
      z-index: 99;
    }

    .center {
        display: block;
        margin-left: auto;
        margin-right: auto;

    }
	  .pop_up_box_text {
	 	  font-family: Georgia, 'Times New Roman', Times, serif;
		  font-size: 16px;
		  line-height: 22px;
		  color: #ffffff;
		  display: inline;
	  }

    .custom-pin {
        background-image: url('gmaps-marker-clusterer-master/images/cm1.png');
        background-repeat: no-repeat;
        background-size: 50px;
        /*height: 1em;*/
        /*line-height: 1;*/
        /*width: 1em;*/
        width: 50px;
        height: 40px;
        padding-top: 1.1em;
        /*padding-right: 21px;*/
        text-align: center;
        cursor: pointer;
        color: #FEF9E2;
        /*background-color: black;*/
        position: absolute;
        z-index: 10;
        /*border-radius: .5em;*/
        font-size: 15px;
        /*font-weight: bold;*/
        /*transition: all 500ms;*/
    }

   /* .custom-pin::after {
        content: '';
        border-width: 1em .5em;
        border-color: black transparent transparent transparent;
        border-style: solid;
        position: absolute;
        top: 99%;
        left: calc(50% - .5em);
    }*/

    .custom-pin:hover {
        transform: scale(1.15);

    }

</style>



<!--Connect to the google maps api using your api key-->
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCC8Od4Dcf51hvm57_VPgMjkIjjOCSZU5s&sensor=true"></script>
<script src="infobox/infobox.js" type="text/javascript"></script>

<!--Main chunk of javascript that creates and controls the map.-->
<script type="text/javascript">


var markersRaw = [];
// {name: 'ΑΘΗΝΕΟ',lat: 38.0036015, log: 23.7072896, latC: 37.9838096, logC:23.7275388,latV: 38.3009838096, logV: 23.7072896, icon: 'athineo.png'},
// {name: 'ΑΝΑΣΤΑΣΙΟΥ ANASTASIOU',lat: 38.02102, log: 23.80189, latC: 37.9838096, logC:23.7275388,latV: 37.9753188, logV: 24.00189-0.05, icon: 'anastasiou.png'},
// {name: 'satiros',lat: 37.9838096, log: 23.7275388, latC: 37.9838096, logC:23.7275388, latV: 38.13838096, logV: 23.6275388, icon: 'satyr.png'},
// {name: 'NOCTUA',lat: 37.9753188, log: 23.7099963, latC: 37.9838096, logC:23.7275388, latV: 37.6753188, logV: 23.8199963, icon: 'noctua.png'},
// {name: 'ASYLUM BEER',lat: 37.948907, log: 23.743755, latC: 37.9838096, logC:23.7275388, latV: 37.8053188, logV: 23.993755 , icon: 'asylum.png'},
// {name: 'ΜΑΡΕΑ ##MAREA',lat: 37.9829262, log: 23.7190463, latC: 37.9838096, logC:23.7275388,latV: 37.7753188, logV: 23.6190463, icon: 'marea.png'},
// {name: 'ΣΤΕΡΓΙΟΥ',lat: 37.8328926, log: 23.8056149, latC: 37.9838096, logC:23.7275388, latV: 37.9838096, logV:23.5275388, icon: 'stergiou.png'},
// {name: 'ZHTA-HTA-ΘΗΤΑ',lat: 38.0231582, log: 23.8073881, latC: 37.9838096, logC:23.7275388,latV: 38.16838096, logV: 23.9073881 ,  icon: 'thita-ita.png'},
var testData = [
  {id: 1,name: "ΕΖΑ",icon: "eza.png", mapUrl: "https://www.google.gr/maps/place/Hellenic+Breweries+of+Atalanti+S.A./@38.6312018,22.7951828,10z/data=!4m8!1m2!2m1!1seza+microbrewery!3m4!1s0x14a0c199d6eb9d8f:0x82c3c2fa7b0d9dda!8m2!3d38.6312018!4d23.0753342", infoUrl: "http://eza.gr/"},
{id: 2,name: "ΒΕΡΓΙΝΑ",icon: "vergina.png", mapUrl: "https://www.google.gr/maps/place/Vergina+Beer+factory/@41.0226797,25.4495604,12.67z/data=!4m5!3m4!1s0x14adf1c6a5dd8b5d:0x15ac71b26c9bb566!8m2!3d41.0738353!4d25.492092", infoUrl: "http://www.verginabeer.com/el/"},
{id: 3,name: "SEPTEM",icon: "septem.png", mapUrl: "https://www.google.gr/maps/place/Septem+Microbrewery/@38.5350089,24.1108791,15z/data=!4m5!3m4!1s0x0:0x38bac46c537cb731!8m2!3d38.5350089!4d24.1108791", infoUrl: "http://septem.gr/"},
{id: 4,name: "CORFU BEER",icon: "corfu.png", mapUrl: "https://www.google.gr/maps/place/Corfu+Beer+%CE%9A%CE%B5%CF%81%CE%BA%CF%85%CF%81%CE%B1%CF%8A%CE%BA%CE%AE+%CE%96%CF%85%CE%B8%CE%BF%CF%80%CE%BF%CE%B9%CE%AF%CE%B1/@39.7468394,19.648364,14.25z/data=!4m5!3m4!1s0x135b4dfb775399a1:0xd79fd6503283f090!8m2!3d39.7494378!4d19.6568128", infoUrl: "http://www.corfubeer.com/index.html"},
{id: 5,name: "ZEOS",icon: "zeos.png", mapUrl: "https://www.google.gr/maps/place/Zeos+Breweries+S.A./@37.6580027,22.7437014,16z/data=!4m5!3m4!1s0x149ffbe14f3ea941:0xa835c99f7977dd30!8m2!3d37.6590984!4d22.7457882", infoUrl: "http://zeosbrewery.com/"},
{id: 6,name: "MAGNUS",icon: "magnus.png", mapUrl: "https://www.google.gr/maps/place/Magnus+Magister+Papadimitriou+S.A/@36.3706317,28.0650966,13.25z/data=!4m8!1m2!2m1!1zzpbOpc6Yzp_OoM6fzpnOmc6RIM6hzp_OlM6fzqU!3m4!1s0x14957b25cbab085b:0x1ef85d77f93e4614!8m2!3d36.3772406!4d28.0978346", infoUrl: "http://magnusmagister.gr/"},
{id: 7,name: "BRINKS",icon: "brinks.png", mapUrl: "https://www.google.gr/maps/place/Rethymnian+Brewery+S.A./@35.3024262,24.4583361,16z/data=!4m5!3m4!1s0x149b7508ce2e3fed:0x82d765b479de9af!8m2!3d35.3032668!4d24.4599937", infoUrl: "http://www.brinks-beer.gr/"},
{id: 8,name: "CRAZY DONKEY",icon: "donkey.png", mapUrl: "https://www.google.gr/maps/place/Santorini+Brewing+Company/@36.4071539,25.4206309,12z/data=!4m8!1m2!2m1!1zzpbOpc6Yzp_OoM6fzpnOmc6RIM6jzpHOnc6kzp_Ooc6Zzp3Ol86j!3m4!1s0x1499ce18f7a849df:0x2e572f9b2c435648!8m2!3d36.384082!4d25.4645213", infoUrl: "http://www.santorinibrewingcompany.gr/"},
{id: 9,name: "CHIOS BEER",icon: "chios.png", mapUrl: "https://www.google.gr/maps/place/Chios+Beer+-+%CE%96%CF%85%CE%B8%CE%BF%CF%80%CE%BF%CE%B9%CE%AF%CE%B1+%CE%A7%CE%AF%CE%BF%CF%85/@38.319989,26.126711,17z/data=!3m1!4b1!4m5!3m4!1s0x14bb615187908c63:0x1f6fe99f353179ff!8m2!3d38.319989!4d26.126711", infoUrl: "http://www.chiosbeer.gr/fresh/el/"},
{id: 10,name: "ΒΑΠ",icon: "vap.png", mapUrl: "https://www.google.gr/maps/place/Vap+P.+Kouyos+S.A./@36.3818988,28.1978325,17z/data=!4m12!1m6!3m5!1s0x149563f7e20038f5:0xd2680a6de4a5f42c!2sVap+P.+Kouyos+S.A.!8m2!3d36.3818988!4d28.1978325!3m4!1s0x149563f7e20038f5:0xd2680a6de4a5f42c!8m2!3d36.3818988!4d28.1978325", infoUrl: "http://vap.gr/zythos/"},
{id: 11,name: "ΝΗΣΟΣ",icon: "nhsos.png", mapUrl: "https://www.google.gr/maps/place/%CE%9D%CE%97%CE%A3%CE%9F%CE%A3+Beer/@37.6017436,25.1131911,11z/data=!4m8!1m2!2m1!1zzpzOmc6azqHOn86WzqXOmM6fzqDOn86ZzpnOkSDOms6lzprOm86RzpTOqc6dIM6jzqTOl86dIM6kzpfOnc6f!3m4!1s0x14a2ec02da080b6f:0xa050ccefda014c8b!8m2!3d37.5388756!4d25.1749806", infoUrl: "http://nissos.beer/"},
{id: 12,name: "ΧΑΡΜΑ",icon: "charma.png", mapUrl: "https://www.google.gr/maps/place/Cretan+Brewery+S.A.+%CE%9A%CF%81%CE%B7%CF%84%CE%B9%CE%BA%CE%AE+%CE%96%CF%85%CE%B8%CE%BF%CF%80%CE%BF%CE%B9%CE%AF%CE%B1+%CE%91.%CE%95/@35.48685,23.825786,17z/data=!3m1!4b1!4m12!1m6!3m5!1s0x149c8bb3ccd1b743:0x318bf645e5ada059!2zQ3JldGFuIEJyZXdlcnkgUy5BLiDOms-BzrfPhM65zrrOriDOls-FzrjOv8-Azr_Ouc6vzrEgzpEuzpU!8m2!3d35.48685!4d23.825786!3m4!1s0x149c8bb3ccd1b743:0x318bf645e5ada059!8m2!3d35.48685!4d23.825786", infoUrl: "https://www.cretanbeer.gr/#xarma"},
{id: 13,name: "ΒΟΡΕΙΑ",icon: "voreia.png", mapUrl: "https://www.google.gr/maps/place/SIRIS+MICROBREWERY+E.E./@41.0845604,23.6175281,17z/data=!3m1!4b1!4m12!1m6!3m5!1s0x14a951544e6b926f:0x8af52ba095597e93!2sSIRIS+MICROBREWERY+E.E.!8m2!3d41.0845604!4d23.6175281!3m4!1s0x14a951544e6b926f:0x8af52ba095597e93!8m2!3d41.0845604!4d23.6175281", infoUrl: "http://www.sirisbrewery.gr/"},
{id: 14,name: "VOLKAN",icon: "volkan.png", mapUrl: "https://www.google.com/maps/place/First+Lomax+Sole+Shareholder+Co.+Ltd/@36.42,25.429478,17z/data=!3m1!4b1!4m5!3m4!1s0x1499cdd2010f946f:0xa391dfd88865f823!8m2!3d36.42!4d25.4316667", infoUrl: "http://volkanbeer.com/#welcome"},
{id: 15,name: "ZHTA-HTA-ΘΗΤΑ",icon: "thita-ita.png", mapUrl: "https://www.google.com/maps/place/Diogenous+8,+Chalandri+152+34/@38.0231582,23.8051994,17z/data=!3m1!4b1!4m5!3m4!1s0x14a198fc49067511:0xc2d87ea7b50f038a!8m2!3d38.0231582!4d23.8073881", infoUrl: "http://thessaliki-beer.gr/"},
{id: 16,name: "CANAL DIVE",icon: "canal.png", mapUrl: "https://www.google.gr/maps/place/%CE%9A%CE%9F%CE%A1%CE%99%CE%9D%CE%98%CE%99%CE%91%CE%9A%CE%97+%CE%96%CE%A5%CE%98%CE%9F%CE%A0%CE%9F%CE%99%CE%AA%CE%91+%CE%91.%CE%95./@37.9234561,22.8710389,15z/data=!4m8!1m2!2m1!1zzprOn86hzpnOnc6YzpnOkc6azpcgzpbOpc6Yzp_OoM6fzpnOmc6R!3m4!1s0x14a011671a7e0577:0x72f53c6a9c48af1c!8m2!3d37.9234561!4d22.8797936", infoUrl: "http://corinthianbrewery.gr/"},
{id: 17,name: "SOLO",icon: "solo.png", mapUrl: "https://www.google.gr/maps/place/Kountouriotou+35,+Iraklio+141+22/@38.0493798,23.7621617,17z/data=!3m1!4b1!4m5!3m4!1s0x14a198a096b2772d:0x2c60f93bc94f6b96!8m2!3d38.0493798!4d23.7643504", infoUrl: "http://solobeer.gr/"},
{id: 18,name: "ΣΤΕΡΓΙΟΥ",icon: "stergiou.png", mapUrl: "https://www.google.com/maps/place/Triptolemou+17,+Vari+166+72/@37.8328926,23.8034262,17z/data=!4m13!1m7!3m6!1s0x14a195215ca68417:0xe16d5f4875e755ea!2sTriptolemou+17,+Vari+166+72!3b1!8m2!3d37.8328926!4d23.8056149!3m4!1s0x14a195215ca68417:0xe16d5f4875e755ea!8m2!3d37.8328926!4d23.8056149", infoUrl: "http://mpyrastergiou.gr/#"},
{id: 19,name: "ΠΛΑΣΤΙΓΓΑ",icon: "plastigga.png", mapUrl: "https://www.google.com/maps/place/Ermou+64,+Volos+383+33/@39.3627696,22.9415707,17z/data=!4m13!1m7!3m6!1s0x14a76c65b747feef:0x96871f8c77ad610b!2sErmou+64,+Volos+383+33!3b1!8m2!3d39.3627696!4d22.9437594!3m4!1s0x14a76c65b747feef:0x96871f8c77ad610b!8m2!3d39.3627696!4d22.9437594", infoUrl: "http://plastiga.gr/zithopoiia/"},
{id: 20,name: "ΣΚΝΙΠΑ",icon: "sknipa.png", mapUrl: "https://www.google.gr/maps/place/SKNIPA+%CE%A0%CF%81%CF%8C%CF%84%CF%85%CF%80%CE%B7+%CE%9C%CE%B9%CE%BA%CF%81%CE%BF%CE%B6%CF%85%CE%B8%CE%BF%CF%80%CE%BF%CE%B9%CE%AF%CE%B1/@40.5280406,23.0413982,17z/data=!3m1!4b1!4m5!3m4!1s0x14a84051dd872c1d:0xfff156573db85f74!8m2!3d40.5280406!4d23.0413982", infoUrl: "http://sknipa.gr/"},
{id: 21,name: "KEFALLONIAN BEER",icon: "kefallonian.png", mapUrl: "https://www.google.gr/maps/place/Kefalonian+Beer+-+%CE%9C%CE%B9%CE%BA%CF%81%CE%BF%CE%B6%CF%85%CE%B8%CE%BF%CF%80%CE%BF%CE%B9%CE%AF%CE%B1+%CE%9A%CE%B5%CF%86%CE%B1%CE%BB%CE%BF%CE%BD%CE%B9%CE%AC%CF%82+%26+%CE%99%CE%B8%CE%AC%CE%BA%CE%B7%CF%82/@38.2567968,20.6269362,17z/data=!4m12!1m6!3m5!1s0x135d8dda9155abb5:0xc645f2fd9b275254!2zS2VmYWxvbmlhbiBCZWVyIC0gzpzOuc66z4HOv862z4XOuM6_z4DOv865zq_OsSDOms61z4bOsc67zr_Ovc65zqzPgiAmIM6ZzrjOrM66zrfPgg!8m2!3d38.2567968!4d20.6269362!3m4!1s0x135d8dda9155abb5:0xc645f2fd9b275254!8m2!3d38.2567968!4d20.6269362", infoUrl: "http://www.kefalonianbeer.com/"},
{id: 22,name: "ΑΛΗ",icon: "ali.png", mapUrl: "https://www.google.gr/maps/place/%CE%9C%CE%B9%CE%BA%CF%81%CE%BF%CE%B6%CF%85%CE%B8%CE%BF%CF%80%CE%BF%CE%B9%CE%AF%CE%B1+%CE%98%CE%B5%CF%83%CF%83%CE%B1%CE%BB%CE%BF%CE%BD%CE%AF%CE%BA%CE%B7%CF%82/@40.6859526,22.747106,12z/data=!4m8!1m2!2m1!1zzpzOmc6azqHOn86WzqXOmM6fzqDOn86ZzpnOkSDOmM6VzqPOo86RzpvOn86dzpnOms6XzqM!3m4!1s0x14a83ab152d46f0b:0xea139b01dc260b12!8m2!3d40.6859526!4d22.8171438", infoUrl: "http://www.alibeer.gr/"},
{id: 23,name: "ΟΛΥΜΠΟΣ",icon: "olymposbeer.png", mapUrl: "https://www.google.com/maps/place/Thessalonikis+106,+Katerini+601+00/@40.2786946,22.5141866,17z/data=!4m13!1m7!3m6!1s0x135802189b242f79:0x76691dfa67c1e013!2sThessalonikis+106,+Katerini+601+00!3b1!8m2!3d40.2786946!4d22.5163753!3m4!1s0x135802189b242f79:0x76691dfa67c1e013!8m2!3d40.2786946!4d22.5163753", infoUrl: "http://olymposbeer.gr/"},
{id: 24,name: "ΔΙΩΝΗ-ΟΡΑ",icon: "patraiki.png", mapUrl: "https://www.google.gr/maps/place/PATRAIKI+ZYTHOPOIIA+P.C./@38.1751188,21.6814406,17z/data=!3m1!4b1!4m5!3m4!1s0x135e3708bb07c613:0xac4b5ce025ac326d!8m2!3d38.1751188!4d21.6814406", infoUrl: "http://www.patrabeer.gr/"},
{id: 25,name: "ΣΤΑΛΛΑ ΡΟΥΣΣΑ",icon: "stala.png", mapUrl: "https://www.google.com/maps/place/Rodotopi+455+00/@39.7075519,20.7218318,16z/data=!3m1!4b1!4m5!3m4!1s0x135bc01d612efb95:0xe93ee1fc84bcfa90!8m2!3d39.7083252!4d20.7237136", infoUrl: "http://www.epirusmb.gr/"},
{id: 26,name: "ΣΤΙΛΒΗ",icon: "stilvi.png", mapUrl: "https://www.google.gr/maps/place/%CE%96%CF%85%CE%B8%CE%BF%CF%80%CE%BF%CE%B9%CE%AF%CE%B1+%CE%98%CE%B5%CF%83%CF%83%CE%B1%CE%BB%CE%AF%CE%B1%CF%82+%CE%99%CE%9A%CE%95/@39.3847865,21.9164006,17z/data=!3m1!4b1!4m5!3m4!1s0x1358d93b6490ef7b:0x514730a17c833e7!8m2!3d39.3847865!4d21.9185893", infoUrl: "http://stilvibeer.gr/"},
{id: 27,name: "ΜΑΡΕΑ ",icon: "marea.png", mapUrl: "https://www.google.com/maps/place/Millerou+27,+Athina+104+36/@37.9829262,23.7168576,17z/data=!3m1!4b1!4m5!3m4!1s0x14a1bd26f92bf25d:0x3962df9fbdc75349!8m2!3d37.9829262!4d23.7190463", infoUrl: "http://www.delphibeer.gr/"},
{id: 28,name: "ΑΘΗΝΕΟ",icon: "athineo.png", mapUrl: "https://www.google.com/maps/place/Leof.+Kifisou+102,+Peristeri+121+32/@38.0036015,23.7051009,17z/data=!3m1!4b1!4m5!3m4!1s0x14a1a32e85ad0713:0x5b53363996664b53!8m2!3d38.0036015!4d23.7072896", infoUrl: "https://www.athineo.gr/"},
{id: 29,name: "ΛΥΡΑ",icon: "lyra.png", mapUrl: "https://www.google.gr/maps/place/LYRA+BEER+%CE%9C%CE%B5%CF%83%CE%BF%CE%B3%CE%B5%CE%B9%CE%B1%CE%BA%CE%AE+%CE%9C%CE%B9%CE%BA%CF%81%CE%BF%CE%B6%CF%85%CE%B8%CE%BF%CF%80%CE%BF%CE%B9%CF%8A%CE%B1+%CE%9A%CF%81%CE%AE%CF%84%CE%B7%CF%82/@35.4954916,23.6545257,17z/data=!3m1!4b1!4m5!3m4!1s0x149cf6b0748f4777:0xd53c409233321929!8m2!3d35.4954916!4d23.6545257", infoUrl: "https://www.facebook.com/LyraCretanBeer/"},
{id: 30,name: "OLYMPICA MAGNA",icon: "magna.png", mapUrl: "https://www.google.com/maps/place/Elis+Brewery/@37.7307886,21.6164215,9.67z/data=!4m5!3m4!1s0x136096a8888f8c89:0x1ea879a6cc97ed1c!8m2!3d37.7093679!4d21.5595479", infoUrl: "http://www.elisbrewery.com/"},
{id: 31,name: "JOHNNIE'S BEER",icon: "johnnies.png", mapUrl: "https://www.google.gr/maps/place/%CE%9C%CE%B1%CE%BA%CE%B5%CE%B4%CE%BF%CE%BD%CE%B9%CE%BA%CE%AE+%CE%9C%CE%B9%CE%BA%CF%81%CE%BF%CE%B6%CF%85%CE%B8%CE%BF%CF%80%CE%BF%CE%B9%CE%AF%CE%B1+-+Johnnies'+Beer/@41.089483,24.224047,17z/data=!3m1!4b1!4m5!3m4!1s0x14aeabf12b3b82fd:0xc7d80e097867b6db!8m2!3d41.089483!4d24.224047", infoUrl: "https://www.facebook.com/%CE%9C%CE%B1%CE%BA%CE%B5%CE%B4%CE%BF%CE%BD%CE%B9%CE%BA%CE%AE-%CE%9C%CE%B9%CE%BA%CF%81%CE%BF%CE%B6%CF%85%CE%B8%CE%BF%CF%80%CE%BF%CE%B9%CE%AF%CE%B1-897729140281738/timeline"},
{id: 32,name: "ΛΗΘΕΝΙΑ",icon: "trikalwn.png", mapUrl: "https://www.google.gr/maps/place/%CE%A4%CF%81%CE%B9%CE%BA%CE%AC%CE%BB%CF%89%CE%BD+%CE%96%CF%8D%CE%B8%CE%BF%CF%82/@39.5467904,21.7739378,17z/data=!3m1!4b1!4m5!3m4!1s0x13591ed7f4afc0f5:0x1c1d8d52de1a7ea6!8m2!3d39.5467904!4d21.7739378", infoUrl: "http://www.trikalabeer.gr/"},
{id: 33,name: "56",icon: "paros2.png", mapUrl: "https://www.google.com/maps/place/37%C2%B006'38.3%22N+25%C2%B014'36.6%22E/@37.1106371,25.2259904,14z/data=!3m1!4b1!4m13!1m7!3m6!1s0x0:0x0!2zMzfCsDA2JzM4LjMiTiAyNcKwMTQnMzYuNiJF!3b1!8m2!3d37.11064!4d25.24349!3m4!1s0x0:0x0!8m2!3d37.11064!4d25.24349", infoUrl: "http://56islesbeer.gr/el/"},
{id: 34,name: "ΘΕΡΟΣ",icon: "theros.png", mapUrl: "https://www.google.gr/maps/place/Solar+micro+brewery+Xanthi/@41.112538,24.87042,17z/data=!3m1!4b1!4m5!3m4!1s0x14ac2ceda125ebab:0xe36f8a739f14d193!8m2!3d41.112538!4d24.87042", infoUrl: "http://www.solarbeer.gr/"},
{id: 35,name: "ΚΑΤΣΙΚΑ",icon: "katsika.png", mapUrl: "https://www.google.com/maps/place/36%C2%B037'33.7%22N+24%C2%B055'08.2%22E/@36.626027,24.9101896,15z/data=!3m1!4b1!4m13!1m7!3m6!1s0x0:0x0!2zMzbCsDM3JzMzLjciTiAyNMKwNTUnMDguMiJF!3b1!8m2!3d36.62603!4d24.91894!3m4!1s0x0:0x0!8m2!3d36.62603!4d24.91894", infoUrl: "https://www.facebook.com/folegandrosbrewery/"},
{id: 36,name: "NAXOS BEER",icon: "naxos.png", mapUrl: "https://www.google.com/maps/place/Naxos/@37.0598888,25.3295715,11z/data=!3m1!4b1!4m13!1m7!3m6!1s0x149808a6fa0089c1:0xf47adb634b92d218!2sNaxos!3b1!8m2!3d37.1035665!4d25.3776734!3m4!1s0x149808a6fa0089c1:0xf47adb634b92d218!8m2!3d37.1035665!4d25.3776734", infoUrl: "http://naxos.beer/"},
{id: 37,name: "ΗΠΕΙΡΟΣ",icon: "ipiros.png", mapUrl: "https://www.google.com/maps/place/Grimpovou+19,+Arta+471+00/@39.1601208,20.9808905,17z/data=!3m1!4b1!4m5!3m4!1s0x135c1b6903179839:0xe4b0fe27591a063b!8m2!3d39.1601208!4d20.9830792", infoUrl: "http://www.epirusbrewery.gr/"},
{id: 38,name: "SPARTA",icon: "sparta.png", mapUrl: "https://www.google.com/maps/place/Lakoniki+Brewery/@36.89304,22.5166913,17z/data=!4m13!1m7!3m6!1s0x0:0x0!2zMzbCsDUzJzM0LjkiTiAyMsKwMzEnMDguMCJF!3b1!8m2!3d36.89304!4d22.51888!3m4!1s0x0:0xb44010a0916dfe17!8m2!3d36.8930947!4d22.5184697", infoUrl: "http://spartabeer.gr/"},
{id: 39,name: "FONIAS",icon: "samothraki.png", mapUrl: "https://www.google.gr/maps/place/%CE%9C%CE%B9%CE%BA%CF%81%CE%BF%CE%B6%CF%85%CE%B8%CE%BF%CF%80%CE%BF%CE%B9%CE%AF%CE%B1+%CE%A3%CE%B1%CE%BC%CE%BF%CE%B8%CF%81%CE%AC%CE%BA%CE%B7%CF%82+%2F+Samothraki+Microbrewery/@40.4732432,25.4807834,15z/data=!4m5!3m4!1s0x0:0xbafa059bd20c6718!8m2!3d40.4732432!4d25.4807834", infoUrl: "http://www.samothrakibeer.gr/index.php/el/"},
{id: 40,name: "NOCTUA",icon: "noctua.png", mapUrl: "https://www.google.gr/maps/place/Noctua+Brewery+Athens/@37.9753188,23.7099963,17z/data=!3m1!4b1!4m5!3m4!1s0x14a1bce0d4746151:0x551e97ccd19f4fa8!8m2!3d37.9753188!4d23.7099963", infoUrl: "http://noctua.gr/"},
{id: 41,name: "VAMBEER",icon: "korfi.png", mapUrl: "https://www.google.com/maps/place/Korfi+S.A./@40.2700533,22.5126179,17z/data=!3m1!4b1!4m5!3m4!1s0x1358023a4254f3d7:0x1c636a6e7e6d69f1!8m2!3d40.2700533!4d22.5148066", infoUrl: "http://vambeer.gr/"},
{id: 42,name: "MYKONOS",icon: "mikonos.png", mapUrl: "https://www.google.gr/maps/place/Mykonos+Brewing+Company/@37.447288,25.344194,17z/data=!3m1!4b1!4m5!3m4!1s0x14a2bf10120d7abb:0x11b51e385bd2d1a3!8m2!3d37.447288!4d25.344194", infoUrl: "http://www.mikonu.gr/"},
{id: 43,name: "NOTOΣ",icon: "notos.png", mapUrl: "https://www.google.gr/maps/place/Notos+Brewery/@35.3294596,25.114209,17z/data=!3m1!4b1!4m5!3m4!1s0x149a59f25affe157:0x12ec492facfb3b84!8m2!3d35.3294596!4d25.114209", infoUrl: "http://notosbrewery.gr/"},
{id: 44,name: "ΚΑΡΜΑ",icon: "karma.png", mapUrl: "https://www.google.com/maps/place/KARMA+%CE%96%CF%85%CE%B8%CE%BF%CF%80%CE%BF%CE%B9%CE%AF%CE%B1+%CE%A0%CE%B5%CE%BB%CE%BF%CF%80%CE%BF%CE%BD%CE%BD%CE%AE%CF%83%CE%BF%CF%85/@37.823823,22.647369,12z/data=!4m5!3m4!1s0x0:0x83635b5a4748685a!8m2!3d37.819755!4d22.647712", infoUrl: "http://www.karmabeer.gr/"},
{id: 45,name: "ASYLUM BEER",icon: "asylum.png", mapUrl: "https://www.google.gr/maps/place/Anagenniseos+1,+Imittos+172+36/@37.948907,23.7415663,17z/data=!3m1!4b1!4m13!1m7!3m6!1s0x14a1bd9e40ffeec5:0xf3c8162293b557d3!2sAnagenniseos+1,+Imittos+172+36!3b1!8m2!3d37.948907!4d23.743755!3m4!1s0x14a1bd9e40ffeec5:0xf3c8162293b557d3!8m2!3d37.948907!4d23.743755", infoUrl: "https://www.asylumbeer.gr/"},
{id: 46,name: "LEVANTE",icon: "levande.png", mapUrl: "https://www.google.gr/maps/place/LEVANTE+BEERS+ZAKYNTHOS/@37.8723145,20.7307569,17z/data=!4m12!1m6!3m5!1s0x13674217779bfd77:0xb33b205f4ff8ea7!2sLEVANTE+BEERS+ZAKYNTHOS!8m2!3d37.8723145!4d20.7329456!3m4!1s0x13674217779bfd77:0xb33b205f4ff8ea7!8m2!3d37.8723145!4d20.7329456", infoUrl: "http://s466958426.online.de/levantebeersgreek/"},
{id: 47,name: "ΙΚΑΡΙΩΤΙΣΣΑ",icon: "ikariotissa.png", mapUrl: "https://www.google.gr/maps/place/Icaria/@37.5998642,26.0296138,11z/data=!3m1!4b1!4m5!3m4!1s0x14bd1d88f2402c4f:0x2a22c3406064214f!8m2!3d37.5967227!4d26.1123078", infoUrl: "https://www.facebook.com/%CE%99%CE%BA%CE%B1%CF%81%CE%B9%CE%B1%CE%BA%CE%B7-%CE%BC%CE%B9%CE%BA%CF%81%CE%BF%CE%B6%CF%85%CE%B8%CE%BF%CF%80%CE%BF%CE%B9%CE%B9%CE%B1-478324978982175/"},
{id: 48,name: "ONIRO",icon: "dreamer.png", mapUrl: "https://www.google.gr/maps/place/40%C2%B030'55.0%22N+22%C2%B012'12.9%22E/@40.51528,22.2013913,17z/data=!3m1!4b1!4m5!3m4!1s0x0:0x0!8m2!3d40.51528!4d22.20358", infoUrl: "https://www.facebook.com/dreamerbrewing/"},
{id: 49,name: "ΑΝΑΣΤΑΣΙΟΥ",icon: "anastasiou.png", mapUrl: "https://www.google.com/maps/place/Chaimanta+25,+Chalandri+152+34/@38.0210252,23.8000943,17.25z/data=!4m5!3m4!1s0x14a198f907fa9781:0x223462a5dbe595ba!8m2!3d38.0209768!4d23.8019962", infoUrl: "https://www.facebook.com/zythosanastasiou/?hc_ref=ARRSDmVpmEUodMNg8kxqWUNJ-pEcLBYrGYQ2e7yaa9m4xkxs0RxDg0Og9orYHd90oSo"},
{id: 50,name: "satiros",icon: "satyr.png", mapUrl: "https://www.google.com/maps/place/Athens/@37.990832,23.7033198,13z/data=!3m1!4b1!4m5!3m4!1s0x14a1bd1f067043f1:0x2736354576668ddd!8m2!3d37.9838096!4d23.7275388", infoUrl: "http://www.satyrbrews.gr"},
{id: 51,name: "SEVEN ISLAND",icon: "seven_island.png", mapUrl: "https://www.google.com/maps/place/39%C2%B037'06.5%22N+19%C2%B054'26.8%22E/@39.61847,19.9052413,17z/data=!3m1!4b1!4m5!3m4!1s0x0:0x0!8m2!3d39.61847!4d19.90743", infoUrl: "https://www.google.com/maps/place/39%C2%B037'06.5%22N+19%C2%B054'26.8%22E/@39.61847,19.9052413,17z/data=!3m1!4b1!4m5!3m4!1s0x0:0x0!8m2!3d39.61847!4d19.90743"},
{id: 52,name: "ΑΡΓΩ",icon: "argo.png", mapUrl: "https://www.google.gr/maps/place/%CE%9C%CE%B9%CE%BA%CF%81%CE%BF%CE%B6%CF%85%CE%B8%CE%BF%CF%80%CE%BF%CE%B9%CE%AF%CE%B1+%CE%98%CE%B5%CF%83%CF%83%CE%B1%CE%BB%CE%AF%CE%B1%CF%82/@39.3632214,13.9696698,5z/data=!4m8!1m2!2m1!1zzrHPgc6zz4kgYmVlcg!3m4!1s0x14a76c6dc928c34b:0xae93b43a88f4cc55!8m2!3d39.3632214!4d22.9345136", infoUrl: "https://www.facebook.com/volosbeer/"},
{id: 53,name: "DARK CROPS BREWERY",icon: "dark_crops.png", mapUrl: "https://www.google.com/maps/place/Artemidos+125,+Paleo+Faliro+175+62/@37.9264714,23.7010706,17z/data=!3m1!4b1!4m5!3m4!1s0x14a1bc2579c44adf:0xeb587fc7a1018f58!8m2!3d37.9264714!4d23.7032593", infoUrl: "http://www.darkcrops.com"},
{id: 54,name: "JASMINE",icon: "jasmine.png", mapUrl: "https://www.google.com/maps/place/Athens/@37.990832,23.7033198,13z/data=!3m1!4b1!4m5!3m4!1s0x14a1bd1f067043f1:0x2736354576668ddd!8m2!3d37.9838096!4d23.7275388", infoUrl: "http://www.strangebrew.gr/"},
{id: 55,name: "HOPPY CARAVAN",icon: "hoppy_caravan.png", mapUrl: "https://www.google.gr/maps/place/Athens/@37.990832,23.7033198,13z/data=!3m1!4b1!4m5!3m4!1s0x14a1bd1f067043f1:0x2736354576668ddd!8m2!3d37.9838096!4d23.7275388", infoUrl: "https://www.facebook.com/Hoppy-Caravan-1659696870945806/"},
{id: 56,name: "WINGS",icon: "icarian_spirit.png", mapUrl: "https://www.google.gr/maps/place/37%C2%B033'39.6%22N+26%C2%B003'11.6%22E/@37.5610042,26.0510214,17z/data=!3m1!4b1!4m5!3m4!1s0x0:0x0!8m2!3d37.5610042!4d26.0532101", infoUrl: "https://untappd.com/w/the-icarian-spirit-microbrewery/345939"},
{id: 57,name: "ΛΕΥΚΑ ΟΡΗ",icon: "lafkas.png", mapUrl: "https://www.google.com/maps/place/Lafkas+Brewery/@35.4945808,23.9838765,17z/data=!3m1!4b1!4m5!3m4!1s0x149c8788ddc82b49:0x8ee32eaeecced606!8m2!3d35.4945808!4d23.9860652", infoUrl: "https://lafkasbrewery.com"},
{id: 58,name: "PIKRI-KIRKH-NIKH",icon: "kirki.png", mapUrl: "https://www.google.com/maps/place/Koundourou+Manousou+36,+Pireas+185+33/@37.9383906,23.6554681,17z/data=!3m1!4b1!4m5!3m4!1s0x14a1bbfaa1d8bafd:0x9b02119dff455d9f!8m2!3d37.9383906!4d23.6576568", infoUrl: "www.pikribeer.gr"},
{id: 59,name: "ΠΕΡΙΣΤΕΡΙ",icon: "peristeri.png", mapUrl: "https://www.google.gr/maps/place/Peristeri/@38.0156529,23.6571215,13z/data=!3m1!4b1!4m5!3m4!1s0x14a1a338a717f79b:0x400bd2ce2b97ab0!8m2!3d38.0176649!4d23.6859275", infoUrl: ""},
{id: 60,name: "ΠΕΙΡΑΙΑΣ",icon: "piraiki.png", mapUrl: "https://www.google.gr/maps/place/Piraeus+Microbrewery+S.A./@37.9466559,23.6230802,15z/data=!4m5!3m4!1s0x0:0x7c4110cd57d5fcaa!8m2!3d37.9466559!4d23.6230802", infoUrl: "www.piraikibeer.gr"},
{id: 61,name: "ΑΘΗΝΑ",icon: "midnight_circus.png", mapUrl: "https://www.google.com/maps/place/Str.+Kontouli+7,+Athina+117+42/@37.9656671,23.7245736,17z/data=!3m1!4b1!4m8!1m2!2m1!1sMidnight+Circus+Gypsy+Brewing,Str.+Kontouli+7,+Athens,+,+Greece,+11742!3m4!1s0x14a1bd1a9061c205:0xb94eed9688c01729!8m2!3d37.965667!4d23.7267626", infoUrl: "www.midnightcircus.gr"},
{id: 62,name: "ΛΑΡΙΣΑ",icon: "phneios.png", mapUrl: "https://www.google.gr/maps/place/Paleologou+19,+Larisa+412+23/@39.6303528,22.4196001,17z/data=!3m1!4b1!4m5!3m4!1s0x135888a3c7e7626d:0x2b40bf5a36f28c9!8m2!3d39.6303528!4d22.4217888", infoUrl: "www.lolabeer.gr"},
{id: 63,name: "ΣΚΟΠΕΛΟΣ",icon: "spira.png", mapUrl: "https://www.google.com/maps/place/39%C2%B007'12.1%22N+23%C2%B043'49.1%22E/@39.12003,23.7281213,17z/data=!3m1!4b1!4m5!3m4!1s0x0:0x0!8m2!3d39.12003!4d23.73031", infoUrl: "https://www.facebook.com/SPIRA-Skopelos-Brewers-159198968079788/"},
{id: 64,name: "Flaros",icon: "", mapUrl: "https://www.google.com/maps/place/Greece/@38.0602394,19.9890939,6z/data=!3m1!4b1!4m5!3m4!1s0x135b4ac711716c63:0x363a1775dc9a2d1d!8m2!3d39.074208!4d21.824312", infoUrl: "http://flaros.beer/"},
{id: 65,name: "Manitaria Drifis",icon: "", mapUrl: "https://www.google.com/maps/place/MANITARIA+DIRFIS+-+DIRFIS+MUSHROOMS/@37.8861365,21.7256671,7.88z/data=!4m5!3m4!1s0x14a138b16b8063ed:0xcc3d5d06e7435d09!8m2!3d38.553542!4d23.747288", infoUrl: "http://www.manitariadirfis.gr/"},
{id: 66,name: "Noble Men Beer",icon: "", mapUrl: "https://www.google.com/maps/place/Imittou+190,+Athina+116+36/@37.9629936,23.7395906,17z/data=!3m1!4b1!4m5!3m4!1s0x14a1bd6d0346b8b9:0x2619b29a1a895d55!8m2!3d37.9629936!4d23.7417793", infoUrl: ""},
{id: 67,name: "Unibar Hellas",icon: "", mapUrl: "https://www.google.com/maps/place/Unibr%C3%A4u/@38.0278585,23.8515193,17z/data=!3m1!4b1!4m5!3m4!1s0x14a1995e1465d091:0xb7a60f6b6b13a48f!8m2!3d38.0278585!4d23.853708", infoUrl: "http://www.unibrau.gr/"},
{id: 68,name: "Valtinger",icon: "", mapUrl: "https://www.google.com/maps/place/40%C2%B003'00.1%22N+23%C2%B025'06.0%22E/@40.0490537,23.4132024,16z/data=!4m5!3m4!1s0x0:0x0!8m2!3d40.05004!4d23.41834", infoUrl: "https://www.facebook.com/valtinger/"},
{id: 69,name: "OK Athens",icon: "", mapUrl: "https://www.google.com/maps/place/O.K.+Athens+Ltd/@37.9259131,23.6889071,17z/data=!4m12!1m6!3m5!1s0x14a1bc21ccbc905f:0x73b7cc7039631a11!2sO.K.+Athens+Ltd!8m2!3d37.9259131!4d23.6910958!3m4!1s0x14a1bc21ccbc905f:0x73b7cc7039631a11!8m2!3d37.9259131!4d23.6910958", infoUrl: "http://www.okathens.gr/"},
];

for (var i=0; i < testData.length; i ++) {

  if (testData[i].mapUrl !== '') {
    console.log("name", testData[i].id);
    var sp = testData[i].mapUrl.split("!3d");

    sp = sp[sp.length-1]


    markersRaw.push({
      name: testData[i].id.toString(),
      lat: Number(sp.split("!4d")[0]),
      log: Number(sp.split("!4d")[1]),
      icon: testData[i].icon,
      mapUrl: testData[i].mapUrl,
      infoUrl: testData[i].infoUrl
    })
  } else {
    console.log("empty")
  }

}
////////////////////////////////////////////////////////////////////

//Create the variables that will be used within the map configuration options.
//The latitude and longitude of the center of the map.

//The degree to which the map is zoomed in. This can range from 0 (least zoomed) to 21 and above (most zoomed).
var beerMapZoom = 7;
//The max and min zoom levels that are allowed.
var beerMapZoomMax = 9;
var beerMapZoomMin = beerMapZoom;

// -------------------------------------------------
var ZINDEX_MARKER = 100;
var MARKER_CAP_SIZE = 30;

var MARKER_CAP_HOVER_FACTOR = 7.5;

var MAX_ZOOM = 12;
var MIN_ZOOM = 2;

var STAR_MODE_MAX_ZOOM = 9;

// -------------------------------------------------
//These options configure the setup of the map.
var beerMapOptions = {
		  center: new google.maps.LatLng(39.074208, 21.824311999999964),
          zoom: 6,
		  maxZoom: MAX_ZOOM,
		  minZoom: MIN_ZOOM,
		  backgroundColor: 'hsla(0, 0%, 0%, 0)',
		  mapTypeId: google.maps.MapTypeId.ROADMAP,

		  panControl: false,
		  mapTypeControl: false,
		  streetViewControl: false,
};
//Create the variable for the main map itself.
var beerMap;
var isStarMode = true; // start is when markers are in "star" position on map, on virtual positions
var currentCapSize = MARKER_CAP_SIZE;

//When the page loads, the line below calls the function below called 'loadbeerMap' to load up the map.
google.maps.event.addDomListener(window, 'load', loadbeerMap);



//THE MAIN FUNCTION THAT IS CALLED WHEN THE WEB PAGE LOADS --------------------------------------------------------------------------------
function loadbeerMap() {
  //The empty map variable ('beerMap') was created above. The line below creates the map, assigning it to this variable.
  //The line below also loads the map into the div with the id 'festival-map' (see code within the 'body' tags below), and applies the 'beerMapOptions' (above) to configure this map.
  beerMap = new google.maps.Map(document.getElementById("festival-map"), beerMapOptions);

  beerMap.addListener('zoom_changed', onZoomChanged);

  loadStyledMap();


  var rainMapOverlay = new google.maps.ImageMapType({
   getTileUrl: function(coord, zoom) {
   return 'tiles2' + '/' +zoom+ '/' +coord.x+ '/' + coord.y +'.png';
   },
   tileSize: new google.maps.Size(256, 256)
  });

  // beerMap.overlayMapTypes.insertAt(0, rainMapOverlay);

  //Calls the function below to load up all the map markers.
  loadMapMarkers(); // create markers list
  // updateMarkersSize();


  // loadClusters();
  // loadBanner();

} // EDN OF loadbeerMap()



var markers = [];
var markersLines = [];
var infoBoxes = [];

function createXMarker(lat, log) {

    var position = new google.maps.LatLng(lat, log);

    // Origins, anchor positions and coordinates of the marker increase in the X
    // direction to the right and in the Y direction down.

    var image = {
      origin: new google.maps.Point(0, 0),
      url: 'icons/pins/x.png',
      scaledSize: new google.maps.Size(20, 20),
      anchor: new google.maps.Point(10, 10),
    };

    // todo: set coords
    var shape = {
      coords: [1, 1, 1, 45, 45, 45, 45, 1],
      type: 'poly'
    };

    var marker = new google.maps.Marker({
      position: position,
      title: 'X',
      animation: google.maps.Animation.DROP,
      draggable: false,
      shape: shape,
      icon: image,
      zIndex: 10
    });

    return marker;
}

function convertFromLatLngToPoint(latlng, map, elementContainingMap){
  console.log(elementContainingMap)
  var worldMapWidth = 256*map.getZoom();

  var mapWidth = elementContainingMap.clientWidth ;
  var mapHeight = elementContainingMap.clientWidth ;

  var mapLonRight = map.getBounds().getNorthEast().lng();
  var mapLonLeft = map.getBounds().getSouthWest().lng();
  var mapLonDelta= mapLonRight-mapLonLeft;

  var mapLatBottom = map.getBounds().getSouthWest().lat();
  var mapLatBottomDegree = mapLatBottom * Math.PI / 180;

  var longitude = latlng.lng();
  var latitude = latlng.lat();

  var x = (longitude - mapLonLeft) * (mapWidth / mapLonDelta);

  latitude = latitude * Math.PI / 180;
  worldMapWidth = ((mapWidth / mapLonDelta) * 360) / (2 * Math.PI);
  var mapOffsetY = (worldMapWidth / 2 * Math.log((1 + Math.sin(mapLatBottomDegree)) / (1 - Math.sin(mapLatBottomDegree))));
  var y = mapHeight - ((worldMapWidth / 2 * Math.log((1 + Math.sin(latitude)) / (1 - Math.sin(latitude)))) - mapOffsetY);



  return [x,y];
}

function getImageObj(url, size) {

  var image = {
      origin: new google.maps.Point(0, 0),
      url: url,
      // scaledSize: new google.maps.Size(60, 88), // short pin
      scaledSize: new google.maps.Size(size, size), // cap
      // anchor: new google.maps.Point(31, 88), // short pin
      anchor: new google.maps.Point(size/2, size/2), // cap
    };

  return image;
}
var tempPinCounter = 1;
function createImageMarker(lat, log, imageUrl, legend) {

    var position = new google.maps.LatLng(lat, log);

    // Origins, anchor positions and coordinates of the marker increase in the X
    // direction to the right and in the Y direction down.
    if (imageUrl == '') {

      imageUrl = 'temp.png';
      if (tempPinCounter <= 30) {
        imageUrl = tempPinCounter + "-min.png";
        tempPinCounter = tempPinCounter + 1;
      }


    }



    // imageUrl = 'sknipa-min.png'
    // todo: set coords
    var shape = {
      coords: [1, 1, 1, 80, 80, 80, 80, 1],
      type: 'poly'
    };

    var marker = new google.maps.Marker({
      position: position,
      title: legend,
      // animation: google.maps.Animation.DROP,
      draggable: false,
      shape: shape,
      icon: getImageObj('icons/pins/'+ imageUrl, MARKER_CAP_SIZE),
      zIndex: ZINDEX_MARKER
    });


    return marker;
}


//Function that loads the map markers.
// markersRaw = markersRaw.slice(1,1)
var lines = [];
function loadMapMarkers (){



    // var infowindow = new google.maps.InfoWindow({
    //   content: contentString
    // });
    //
    // var marker = new google.maps.Marker({
    //   position: uluru,
    //   map: map,
    //   title: 'Uluru (Ayers Rock)'
    // });
    // marker.addListener('click', function() {
    //   infowindow.open(map, marker);
    // });

	for(var i=0; i < markersRaw.length; i++) {
    // console.log(markersRaw[i].lat, markersRaw[i].log)
		// markers.push(createXMarker(markersRaw[i].lat, markersRaw[i].log));

    var lat = markersRaw[i].lat;
    var log = markersRaw[i].log;

    // draw lines
    if (markersRaw[i].latV) {
      lat = markersRaw[i].latV;
      log = markersRaw[i].logV;

      // line
      lineCoord = [
          {lat: markersRaw[i].latC,  lng: markersRaw[i].logC},
          {lat: markersRaw[i].latV, lng: markersRaw[i].logV}
        ];
      path = new google.maps.Polyline({
        path: lineCoord,
        geodesic: true,
        strokeColor: 'white',
        strokeOpacity: 1.0,
        strokeWeight: 2
      });
      lines.push(path);
      path.setMap(beerMap);
    }

    var marker = createImageMarker(lat, log, markersRaw[i].icon, markersRaw[i].name)
    marker.rawData = markersRaw[i];
    markers.push(marker);

    marker.setMap(beerMap);

    // MARKERS EVENT HANDLERS
    google.maps.event.addListener(markers[i], "mouseover_", function() {

           this.setIcon(
            getImageObj(this.getIcon().url, MARKER_CAP_SIZE*MARKER_CAP_HOVER_FACTOR)
            );
           this.setZIndex(ZINDEX_MARKER + 1);});
    google.maps.event.addListener(markers[i], "mouseout_", function() {
       // marker.setIcon(this.icon);

       function test(that) {
        function callback(){
          console.log("sjkdhfjkdhkjsdhfjkhdkjfhdskjhfdjkshfkjdshfkjh")
          that.setIcon(
            getImageObj(that.getIcon().url, get_new_cap_size())
            )

          that.setZIndex(ZINDEX_MARKER);
        }
        return callback

       };
       setTimeout(test(this), 1000);


     });
    google.maps.event.addListener(markers[i], "click", function() {

      // x.style.display = "none"
      showPinPreview(this)
      var latLng = new google.maps.LatLng(this.rawData.lat, this.rawData.log)
      // beerMap.setCenter(latLng);
      // beerMap.setZoom(MAX_ZOOM)

      // var contentString = '<div id="content">'+
      //           '<div id="bodyContent">'+
      //           '<a target="_blank" href="'+this.rawData.infoUrl+'">info</a> <br>'+
      //           '<a target="_blank" href="'+this.rawData.mapUrl+'">Navigate</a>'+
      //           '</div>';
      //
      // var infowindow = new google.maps.InfoWindow({
      //   content: contentString
      // });
      // infowindow.open(beerMap, this)
    });

	}

}

function showPinPreview(pin) {
  var prv = document.getElementById("over-map");
  prv.style.display = "block"
  document.getElementById("preview-pin").src="./icons/pins/" + pin.rawData.icon;
  document.getElementById("preview-info").href=pin.rawData.infoUrl
  document.getElementById("preview-nav").href=pin.rawData.mapUrl
}

function get_new_cap_size() {
  var currentZoom = beerMap.getZoom();
  if (currentZoom >= 10) return MARKER_CAP_SIZE*2;
  if (currentZoom >= 8) return MARKER_CAP_SIZE*1.5;
  return MARKER_CAP_SIZE;
}

function updateMarkersSize() {

  var currentZoom = beerMap.getZoom();

  // we need resize the caps according to new zoom level
  // maybe we will not resize them
  var newCapSize = get_new_cap_size();
  if (currentCapSize != newCapSize) {
    currentCapSize = newCapSize;
    for (var i=0; i < markers.length; i++) {
      markers[i].setIcon(
        getImageObj(markers[i].getIcon().url, newCapSize)
      );
    }
  }
}

// -------------------------- CLUSTERS -----------------
function loadClusters() {
  var clusterStyles = [
    {
      textColor: 'white',
      url: 'gmaps-marker-clusterer-master/images/cap.png',
      height: 52,
      width: 52
    },
   {
      textColor: 'white',
      url: 'gmaps-marker-clusterer-master/images/cap.png',
      height: 50,
      width: 50
    },
   {
      textColor: 'white',
      url: 'gmaps-marker-clusterer-master/images/cap.png',
      height: 50,
      width: 50
    }
  ];

  function getOffset() {

    var z = beerMap.getZoom();

    if (z == 6) {
      return 1.5;
    }

    if (z == 7) {
      return 0.75;
    }

    if (z == 8) {
      return 0.4;
    }

    if (z == 9){
      return 0.2;
    }

    if (z == 10) {
      return 0.1;
    }

    if (z == 11) {
      return 0.05;
    }

  }



  var testMarkers = [];
  var options = {
                imagePath: 'gmaps-marker-clusterer-master/images/m',
                onMouseoverCluster: function (clusterIcon, event) {
                  // console.log(clusterIcon.cluster_.markers_, event)
                  console.log("mouse in", clusterIcon.cluster_.markers_[0]);

                  for(let i=0; i < clusterIcon.cluster_.markers_.length; i++) {
                    var curMarker = clusterIcon.cluster_.markers_[i]
                    console.log(Math.floor(i/5));
                    testMarkers.push(createImageMarker(
                      clusterIcon.cluster_.center_.lat()+getOffset() + 0.7*getOffset()*Math.floor(i/5),
                      clusterIcon.cluster_.center_.lng()-2*getOffset() + getOffset()*(i%5),
                      curMarker.icon.url.split('/')[curMarker.icon.url.split('/').length - 1])
                    );

                    testMarkers[i].setMap(beerMap);
                  }

                  // for(let i=0; i < markerCluster.clusters_.length; i++ ) {
                  //   markerCluster.clusters_[i].setMap(null)
                  // }
                  // markerCluster.clusters_[0].markerClusterer_.setMap(null)


                },
                onMouseoutCluster: function (clusterIcon, event) {
                  console.log("mouse out");

                  for(let i=0; i < testMarkers.length; i++) {
                    testMarkers[i].setMap(null);
                  }
                  testMarkers = []
                },
                __styles: clusterStyles,
                cssClass: 'custom-pin'

              };

   var markerCluster = new MarkerClusterer(beerMap, markers,options);
}

// -------------------------- EVENT HANDLERS -------------

function onZoomChanged() {

  updateMarkersSize();

  var currentZoom = beerMap.getZoom();

  // FROM STAR TO ORIGINAL LOCATION
  if (currentZoom > STAR_MODE_MAX_ZOOM && isStarMode) { // currentZoom not in star mode && previous mode was start Mode
    isStarMode = false;

    // remove lines
    for (var i=0; i < lines.length; i++) {
      lines[i].setMap(null);
    }



    // set oroginal positions to markers
    for (i=0; i < markersRaw.length; i++) {
      if (markersRaw[i].latV) { // only if there is apossibility for virtual position
        var position = new google.maps.LatLng(markersRaw[i].lat, markersRaw[i].log);
        markers[i].setPosition(position)
      }
    }
  }
  else if (!isStarMode && currentZoom <= STAR_MODE_MAX_ZOOM) { // previous mode wasnt start mode and now in star mode
    isStarMode = true;
    for (i=0; i < markersRaw.length; i++) {
      if (markersRaw[i].latV) {
        lat = markersRaw[i].latV;
        log = markersRaw[i].logV;
        var position = new google.maps.LatLng(lat, log);
        markers[i].setPosition(position)
      }
    }

    // redraw lines
    for (i=0; i < lines.length; i++) {
      lines[i].setMap(beerMap);
    }

  }
}
// ------------------------- MAP STYLE ---------------------
function loadStyledMap() {

  var styledMapType = new google.maps.StyledMapType(map_style);

  beerMap.mapTypes.set('styled_map', styledMapType);
  beerMap.setMapTypeId('styled_map');
}

// ------------------------- BANNER ----------------------------
//Function that creates the control panel area, ie. the map title and the 2 buttons just beneath it.
function loadBanner() {


  function createControlPanel (controlPanelDiv){
   controlPanelDiv.style.padding = '0px';
   controlUI = document.createElement('div');
   controlUI.style.border='0px solid white';
   controlUI.style.margin='10px';
   controlUI.style.paddingTop='11px';
   controlUI.style.paddingBottom='5px';
   controlUI.style.paddingLeft='0px';
   controlUI.style.paddingRight='0px';
   controlUI.style.width='245px';
   controlUI.style.height='419px';
   controlPanelDiv.appendChild(controlUI);

   //Map title
   titleBar = document.createElement('div');
   titleBar.style.backgroundColor = '#89CBED';
   titleBar.style.height='255px';
   titleBar.style.width='245px';
   titleBar.style.marginTop='0px';
   titleBar.style.marginBottom='0px';
   titleBar.style.marginLeft='0px';
   titleBar.style.marginRight='0px';
   titleBar.style.paddingTop='6px';
   titleBar.style.paddingBottom='2px';
   titleBar.style.paddingLeft='0px';
   titleBar.style.paddingRight='0px';
   titleBar.style.borderTopLeftRadius='5px';
   titleBar.style.borderTopRightRadius='5px';
   titleBar.style.borderBottomLeftRadius='0px';
   titleBar.style.borderBottomLeftRadius='0px';
   titleBar.style.cssFloat='left';
   titleBar.innerHTML = '<div align="center"><img src="icons/map_title.png" width="230" height="252" border="0"/></div>';
   controlUI.appendChild(titleBar);

   yellowStripe = document.createElement('div');
   yellowStripe.style.backgroundColor = '#FFFF00';
   yellowStripe.style.height='2px';
   yellowStripe.style.width='245px';
   yellowStripe.style.marginTop='3px';
   yellowStripe.style.marginBottom='3px';
   yellowStripe.style.marginLeft='0px';
   yellowStripe.style.marginRight='0px';
   yellowStripe.style.paddingTop='0px';
   yellowStripe.style.paddingBottom='0px';
   yellowStripe.style.paddingLeft='0px';
   yellowStripe.style.paddingRight='0px';
   yellowStripe.style.cssFloat='left';
   yellowStripe.style.fontFamily='Georgia, serif';
   yellowStripe.style.fontSize='14px';
   controlUI.appendChild(yellowStripe);

   //'Smaller' events button.
   smallEvents = document.createElement('div');
   smallEvents.style.height='108px';
   smallEvents.style.width='129px';
   smallEvents.style.marginTop='0px';
   smallEvents.style.marginBottom='0px';
   smallEvents.style.marginLeft='0px';
   smallEvents.style.marginRight='0px';
   smallEvents.style.paddingTop='0px';
   smallEvents.style.paddingBottom='2px';
   smallEvents.style.paddingLeft='0px';
   smallEvents.style.paddingRight='0px';
   smallEvents.style.cssFloat='left';
   smallEvents.innerHTML = '<div align="center" onClick="handelRequests(\'small_events\')" OnMouseOver="this.style.cursor=\'pointer\';" OnMouseOut="this.style.cursor=\'default\';"><img src="icons/button_small_event.png" width="128" height="107" border="0"/></div>';
   controlUI.appendChild(smallEvents);

   //Umbrella button
   brolly = document.createElement('div');
   brolly.style.height='149px';
   brolly.style.width='94px';
   brolly.style.marginTop='0px';
   brolly.style.marginBottom='0px';
   brolly.style.marginLeft='0px';
   brolly.style.marginRight='0px';
   brolly.style.paddingTop='0px';
   brolly.style.paddingBottom='2px';
   brolly.style.paddingLeft='0px';
   brolly.style.paddingRight='0px';
   brolly.style.cssFloat='left';
   brolly.innerHTML = '<div align="center" onClick="handelRequests(\'rainfall\')" OnMouseOver="this.style.cursor=\'pointer\';" OnMouseOut="this.style.cursor=\'default\';"><img src="icons/button_brolly.png" width="93" height="148" border="0"/></div>';
   controlUI.appendChild(brolly);

  }

  var controlPanelDiv = document.createElement('div');
  var beerMapControlPanel = new createControlPanel(controlPanelDiv, beerMap);

  //Add the control panel and reset button (created previously) to the map.
  beerMap.controls[google.maps.ControlPosition.RIGHT_TOP].push(controlPanelDiv);
}
// --------------------------------------------------------
var map_style = [
    {
        "featureType": "all",
        "elementType": "all",
        "stylers": [
            {
                "color": "#ff7000"
            },
            {
                "lightness": "69"
            },
            {
                "saturation": "100"
            },
            {
                "weight": "1.17"
            },
            {
                "gamma": "2.04"
            }
        ]
    },
    {
        "featureType": "all",
        "elementType": "geometry",
        "stylers": [
            {
                "color": "#cb8536"
            }
        ]
    },
    {
        "featureType": "all",
        "elementType": "labels",
        "stylers": [
            {
                "color": "#ffb471"
            },
            {
                "lightness": "66"
            },
            {
                "saturation": "100"
            }
        ]
    },
    {
        "featureType": "all",
        "elementType": "labels.text.fill",
        "stylers": [
            {
                "gamma": 0.01
            },
            {
                "lightness": 20
            }
        ]
    },
    {
        "featureType": "all",
        "elementType": "labels.text.stroke",
        "stylers": [
            {
                "saturation": -31
            },
            {
                "lightness": -33
            },
            {
                "weight": 2
            },
            {
                "gamma": 0.8
            }
        ]
    },
    {
        "featureType": "all",
        "elementType": "labels.icon",
        "stylers": [
            {
                "visibility": "off"
            }
        ]
    },
    {
        "featureType": "landscape",
        "elementType": "all",
        "stylers": [
            {
                "lightness": "-8"
            },
            {
                "gamma": "0.98"
            },
            {
                "weight": "2.45"
            },
            {
                "saturation": "26"
            }
        ]
    },
    {
        "featureType": "landscape",
        "elementType": "geometry",
        "stylers": [
            {
                "lightness": 30
            },
            {
                "saturation": 30
            }
        ]
    },
    {
        "featureType": "poi",
        "elementType": "geometry",
        "stylers": [
            {
                "saturation": 20
            }
        ]
    },
    {
        "featureType": "poi.park",
        "elementType": "geometry",
        "stylers": [
            {
                "lightness": 20
            },
            {
                "saturation": -20
            }
        ]
    },
    {
        "featureType": "road",
        "elementType": "geometry",
        "stylers": [
            {
                "lightness": 10
            },
            {
                "saturation": -30
            }
        ]
    },
    {
        "featureType": "road",
        "elementType": "geometry.stroke",
        "stylers": [
            {
                "saturation": 25
            },
            {
                "lightness": 25
            }
        ]
    },
    {
        "featureType": "water",
        "elementType": "all",
        "stylers": [
            {
                "lightness": -20
            },
            {
                "color": "#ecc080"
            }
        ]
    }
]

map_style = [
  {
    "elementType": "geometry.fill",
    "stylers": [
      {
        "visibility": "off"
      },
      {
        "weight": 2
      }
    ]
  },
  {
    "elementType": "geometry.stroke",
    "stylers": [
      {
        "visibility": "off"
      }
    ]
  },
  {
    "elementType": "labels.text",
    "stylers": [
      {
        "visibility": "off"
      }
    ]
  },
  {
    "featureType": "landscape",
    "stylers": [
      {
        "color": "#c8d7d4"
      },
      {
        "visibility": "on"
      }
    ]
  },
  {
    "featureType": "landscape.man_made",
    "elementType": "geometry.fill",
    "stylers": [
      {
        "visibility": "off"
      }
    ]
  },
  {
    "featureType": "poi",
    "stylers": [
      {
        "visibility": "off"
      }
    ]
  },
  {
    "featureType": "road",
    "stylers": [
      {
        "saturation": -100
      },
      {
        "lightness": 45
      }
    ]
  },
  {
    "featureType": "road",
    "elementType": "geometry.fill",
    "stylers": [
      {
        "color": "#eeeeee"
      }
    ]
  },
  {
    "featureType": "road",
    "elementType": "labels.text.fill",
    "stylers": [
      {
        "color": "#7b7b7b"
      }
    ]
  },
  {
    "featureType": "road",
    "elementType": "labels.text.stroke",
    "stylers": [
      {
        "color": "#ffffff"
      }
    ]
  },
  {
    "featureType": "road.arterial",
    "elementType": "labels.icon",
    "stylers": [
      {
        "visibility": "off"
      }
    ]
  },
  {
    "featureType": "road.highway",
    "stylers": [
      {
        "visibility": "simplified"
      }
    ]
  },
  {
    "featureType": "road.highway",
    "elementType": "geometry",
    "stylers": [
      {
        "visibility": "off"
      }
    ]
  },
  {
    "featureType": "transit",
    "stylers": [
      {
        "visibility": "off"
      }
    ]
  },
  {
    "featureType": "water",
    "stylers": [
      {
        "color": "#46bcec"
      },
      {
        "visibility": "on"
      }
    ]
  },
  {
    "featureType": "water",
    "elementType": "geometry.fill",
    "stylers": [
      {
        "color": "#c8d7d4"
      }
    ]
  },
  {
    "featureType": "water",
    "elementType": "labels.text",
    "stylers": [
      {
        "visibility": "off"
      }
    ]
  },
  {
    "featureType": "water",
    "elementType": "labels.text.fill",
    "stylers": [
      {
        "color": "#070707"
      }
    ]
  },
  {
    "featureType": "water",
    "elementType": "labels.text.stroke",
    "stylers": [
      {
        "color": "#ffffff"
      }
    ]
  }
]

map_style = [
    {
        "featureType": "all",
        "elementType": "all",
        "stylers": [
            {
                "color": "#ff7000"
            },
            {
                "lightness": "69"
            },
            {
                "saturation": "100"
            },
            {
                "weight": "1.17"
            },
            {
                "gamma": "2.04"
            }
        ]
    },
    {
        "featureType": "all",
        "elementType": "geometry",
        "stylers": [
            {
                "color": "#cb8536"
            }
        ]
    },
    {
        "featureType": "all",
        "elementType": "labels",
        "stylers": [
            {
                "color": "#ffb471"
            },
            {
                "lightness": "66"
            },
            {
                "saturation": "100"
            }
        ]
    },
    {
        "featureType": "all",
        "elementType": "labels.text.fill",
        "stylers": [
            {
                "gamma": 0.01
            },
            {
                "lightness": 20
            }
        ]
    },
    {
        "featureType": "all",
        "elementType": "labels.text.stroke",
        "stylers": [
            {
                "saturation": -31
            },
            {
                "lightness": -33
            },
            {
                "weight": 2
            },
            {
                "gamma": 0.8
            }
        ]
    },
    {
        "featureType": "all",
        "elementType": "labels.icon",
        "stylers": [
            {
                "visibility": "off"
            }
        ]
    },
    {
        "featureType": "landscape",
        "elementType": "all",
        "stylers": [
            {
                "lightness": "-8"
            },
            {
                "gamma": "0.98"
            },
            {
                "weight": "2.45"
            },
            {
                "saturation": "26"
            }
        ]
    },
    {
        "featureType": "landscape",
        "elementType": "geometry",
        "stylers": [
            {
                "lightness": 30
            },
            {
                "saturation": 30
            }
        ]
    },
    {
        "featureType": "poi",
        "elementType": "geometry",
        "stylers": [
            {
                "saturation": 20
            }
        ]
    },
    {
        "featureType": "poi.park",
        "elementType": "geometry",
        "stylers": [
            {
                "lightness": 20
            },
            {
                "saturation": -20
            }
        ]
    },
    {
        "featureType": "road",
        "elementType": "geometry",
        "stylers": [
            {
                "lightness": 10
            },
            {
                "saturation": -30
            }
        ]
    },
    {
        "featureType": "road",
        "elementType": "geometry.stroke",
        "stylers": [
            {
                "saturation": 25
            },
            {
                "lightness": 25
            }
        ]
    },
    {
        "featureType": "water",
        "elementType": "all",
        "stylers": [
            {
                "lightness": -20
            },
            {
                "color": "#ecc080"
            }
        ]
    }
]

</script>
<script src="./gmaps-marker-clusterer-master/src/markerclusterer.js">
    </script>

</head>
<body>
     <!--Create the div to hold the map.-->
<div id="wrapper">
  <div id="festival-map">

  </div>

  <div id="over-map">
    <div>
      <img id='preview-pin' class="center" src="./icons/pins/vergina.png" alt="Fjords" width="300" height="300">
      <a id="preview-info" target="_blank" href="">Info</a>
      <a id="preview-nav" target="_blank" href="">Navigate</a>
    </div>

  </div>
</div>



</body>
</html>
